<div id="document" class="<%= render_document_class %> col-sm-12">
  <div id="doc_<%= @document.id.to_s.parameterize %>">
    <% # bookmark/folder functions -%>
    <div class="document-header">
      <%
      @title = the_vernaculator('title_display', 'title_vern_display')
      @subtitle = the_vernaculator('subtitle_display', 'subtitle_vern_display')
      responsibility = field_value 'title_responsibility_display'
      %>
      <% if @title.present? %>
      <h2><%= @title %></h2>
      <% end %>
      <% if @subtitle.present? %>
      <h3 class="subtitle"><%= @subtitle %></h3>
      <% end %>
      <% if responsibility.present? %>
      <h3 class="responsibility"><%= responsibility %></h3>
      <% end %>
    </div>
    <div class="row">
      <div class="cover col-sm-2">
        <div class="iconcover bookcover hidden-xs" id="OCLC:<%= bookcover_oclc(@document) %>" data-oclc="<%= bookcover_oclc(@document) %>">
          <%= image_tag "cornell/layout/placeholder-item.png" , class: "img-thumbnail",  alt: "" %>
          <i class="fa fa-<%= formats_icon_mapping(@document['format'].first) %>" aria-hidden="true"></i>
        </div>
        <div class="item-bookcover">
          <a class="btn btn-sm btn-cul availability-link" href="#availability">Check availability<i class="fa fa-arrow-circle-down" aria-hidden="true"></i></a>
        </div>
      </div>
      <div class="document item-metadata col-sm-10">
        <%= render_document_partial @document, :show %>
      </div>
    </div>
  </div>
  <div class="availability well" id="availability">
    <h3>Availability</h3>
    <% if finding_aid(@document) %>
    <% url_findingaid_display = render_display_link :document => @document, :field => 'url_findingaid_display' %>
    <% if url_findingaid_display.present? %>
    <span class="url_findingaid_display" id="finding_aid"><i class="fa fa-check"></i> <%= url_findingaid_display %></span>
    <% end %>
    <% end %>
    <% if online_url(@document) %>
    <% online_links = render_display_link :document => @document, :field => 'url_access_display', :format => 'raw' %>
    <div class="holdings-online">
      <table  class= "table table-responsive">
          <thead>
            <tr> 
              <th><%= t('blacklight.holdings.loc') %></th>
              <th><%= t('blacklight.holdings.cln') %></th>
              <th><%= t('blacklight.holdings.sta') %></th>
            </tr>
          </thead>
         <tbody>
          <% online_links.each do |link| %>
            <tr>
              <td colspan="2" ><span class="online-link"><%= link %></span></td>
              <td><span class="label label-available"><i class="fa fa-check"></i> Available online</span></td>
            </tr>
          <% end %>
         </tbody>
       </table>
    </div>
    <% end %>
    <div class="holdings" data-bibid="<%= @document.id.to_s %>">
      <%= render "holdings"  %>
    </div>
    <% access_restrictions = field_value 'restrictions_display' %>
    <% if access_restrictions.present? %>
    <span class="access-restriction">
      <h5>Restrictions</h5>
      <%= access_restrictions %>
    </span>
    <% end %>
    <% format = field_value('format').split(" ")[3] %>
    <% if format == 'Book' && online_url(@document) %>
    <span class="terms-of-use">
    <a href="/catalog/tou/<%= @document[:id] %>">Terms of use</a>
    </span>
    <% end %>
    <span class="blacklight-url_access_display"></span>
    <%= @hide_status %>
  </div>
  <% if  field_value('other_availability_json').present? || field_value('workid_display').present?   %>
  <div class="availability well other-forms">
    <h4>Other forms of this work</h4>

 <% if  field_value('other_availability_json').present?  %>
  <% @document['other_availability_json'].each do |form| %>
          <% f = JSON.parse(form) %>
          <div class="other-form">
          <span class="other-form-title"><%= link_to f["title"], "/catalog/#{f["bibid"]}" %></span> 
          
          <% formats = f["format"].split(",") %>
          <% formats.each do |format| %>
          <span class="other-form-format">
          <i class="fa fa-<%= formats_icon_mapping(format) %>"></i><%= format %>
          </span>
          <% end %>
          <span class="other-form-date"><%= f["pub_date"] %></span>
          <span class="other-form-language"><%= f["language"] %></span>
          <span class="other-form-edition"><%= f["edition"] %></span>
          <% if f["sites"].present? %>
            <span class="other-form-online">
              <span class="status-online label label-online">Online</span>
              <% if (f["sites"]) != "Online" %>
                <%= f["sites"] %>
              <% end %>
            </span>
          <% end %>
          <% if f["libraries"].present? %><span class="other-form-libraries">Location: <%= f["libraries"] %></span><% end %>
          </div>
  <% end %>
  <% end %>

     <% if field_value('workid_display').present?  %>     
     <p><%= link_to "See all forms of this work",'/?f[workid_facet][]=' + field_value('workid_facet') %></p>
     <% end %>
  <%end%>
    </div>

</div>

