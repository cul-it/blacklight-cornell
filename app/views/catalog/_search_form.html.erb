<div class="clearfix">
  <div class="search-tools">

    <%= form_tag search_action_url, :method => :get, :class => 'search-form form-inline' do %>
      <%= render_hash_as_hidden_fields(:omit_keys => [:q, :search_field, :qt, :page]).html_safe %>
      <% if !params[:q_row].present? %>
          <div class="form-group col-sm-6">
            <label for="q" class="sr-only"><%= t('blacklight.search.form.q') %></label>
              <%= text_field_tag :q, params[:q], :placeholder => t('blacklight.search.form.q'), :class => "search-query phone-search-query form-control", :id => "q", :autocapitalize => "off" %>
              <div class="advanced-link">
                <%= link_to 'Advanced Search', url_for(:controller=>"advanced", :action=>"index") %> | <a href="http://www.library.cornell.edu/help/catalog">Search Tips</a>
              </div>
          </div>

          <% unless search_fields.empty? %>
            <div class="form-group">
              <label for="search_field" class="sr-only"><%= t('blacklight.search.form.search_field.label') %></label>
              <%= select_tag(:search_field, options_for_select(search_fields, h(params[:search_field])), :title => t('blacklight.search.form.search_field.title'), :class => 'form-control') %>
              <span class="sr-only"><%= t('blacklight.search.form.search_field.post_label') %></span>
            </div>
          <% end %>

          <button id="search-btn" class="btn mobile-search-btn btn-inverse" type="submit">
            <i class="fa fa-search fa-inverse"></i><span class="sr-only"><%=t('blacklight.search.form.submit')%></span>
          </button>
          <!-- </span> -->
        <!-- </div> -->

        <% if !query_has_constraints? %>
          <% if !params[:range].blank? %>

          <%end %>
        <% end %>
      <% end %>
    <% end %>

    <% if params[:q_row].present? %>
      <h2 class="advanced-search">Advanced Search</h2>
    <% end %>

    <%= render :partial => 'did_you_mean' %>
  </div>

    <%# Offer search expansion only under certain conditions %>
    <%# if expandable_search? %>
      <%#= render :partial => 'expand_search' %>
    <%# end %>

    <%# Add simple links to WCL and Summon if an advanced search %>
    <%# if params[:q_row].present? %>
      <%#= render :partial => 'expand_advanced_search' %>
    <%# end %>

  <% if params[:q_row].present? %>
    <div class="advanced-search-link">
      <%#= link_to 'Advanced search', params.except(:f).merge(:controller=>"advanced", :action=>"index"), :class=>"advanced-search-link" %>
      <%#= link_to 'New advanced search', url_for(:controller=>"advanced", :action=>"index"), :class=>"" %>
      <%#= debug params[:search_field_row] %>
      <%= link_to 'Modify advanced search', url_for(:controller=>"advanced", :action=>"edit",
                                                  :q_row=>params[:q_row], :op_row=>params[:op_row], 
                                                  :search_field_row=>params[:search_field_row], 
                                                  :boolean_row=>params[:boolean_row], :f=>params[:f]), :class=>"" %>

      <% if query_has_constraints? || params[:range].present? %>
         or <%=link_to t('blacklight.search.start_over'), url_for(:action=>'index'), :id=>"startOverLink" %>
      <% end %>
    </div>
  <% end %>

  <%= render :partial => "constraints" %>
</div>
